<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
  <meta name="theme-color" content="#0ea5a3">
  <title>FaceDoor</title>
  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="styles.css">
  <!-- Note: face-api.js models must be placed in ./models/ (download separately) -->
  <script defer src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.12.0/dist/tf.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/face-api.js@0.22.2/dist/face-api.min.js"></script>
  <script defer src="app.js"></script>
</head>
<body>
  <header class="app-header">
    <h1>FaceDoor</h1>
    <button id="installBtn" class="secondary" hidden>Instalar</button>
  </header>

  <main class="container">
    <section class="video-section" aria-label="Video e overlay de reconhecimento">
      <video id="inputVideo" autoplay muted playsinline playsinline="true"></video>
      <canvas id="overlay" aria-hidden="true"></canvas>
    </section>

    <section class="controls" role="region" aria-label="Controles">
      <div class="card">
        <h2>Conexão ESP8266</h2>
        <label>IP ou hostname: <input id="espHost" placeholder="192.168.4.1"></label>
        <label>Porta: <input id="espPort" type="number" value="81"></label>
        <label>Protocolo:
          <select id="protocolSelect">
            <option value="auto">Auto (WS then HTTP)</option>
            <option value="ws">WebSocket (recomendado)</option>
            <option value="http">HTTP GET (fallback)</option>
          </select>
        </label>
        <button id="connectBtn">Conectar</button>
        <div id="connStatus" aria-live="polite">Desconectado</div>
      </div>

      <div class="card">
        <h2>Reconhecimento</h2>
        <label>Confiança: <input id="confThreshold" type="range" min="0.5" max="0.99" step="0.01" value="0.7"><span id="confValue">0.70</span></label>
        <label><input id="autoOpen" type="checkbox"> Abrir automaticamente ao reconhecer</label>
        <button id="enrollBtn">Cadastrar rosto</button>
        <button id="clearDbBtn" class="danger">Limpar DB</button>
      </div>

      <div class="card log">
        <h2>Logs</h2>
        <pre id="log" aria-live="polite"></pre>
      </div>
    </section>
  </main>

  <footer class="footer">FaceDoor — rodando localmente</footer>
</body>
</html>
